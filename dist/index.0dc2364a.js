const t=document.body.querySelector(".entry-field"),e=Array.from(t.querySelectorAll(".form-input")),s=document.body.querySelector(".library__items"),a=document.body.querySelector(".button--delete"),r=document.body.querySelector(".error-message");class d{constructor(t,e,s,a,r){this.id=t,this.name=e,this.author=s,this.pages=a,this.status=r}getId(){return this.id}toggleStatus(){this.status="read"===this.status?"unread":"read"}render(){let{id:t,name:e,author:a,pages:r,status:d}=this;s.insertAdjacentHTML("beforeend",`
      <tr class="library__item" data-id=${t}>
        <td>${e}</td>
        <td>${a}</td>
        <td>${r}</td>
        <td><button class="button button--status">${d}</button></td>
        <td><button class="button button--remove">delete</button></td>
      </tr>
    `)}addHandlers(t){let e=document.querySelector(`[data-id='${this.id}'] .button--remove`),s=document.querySelector(`[data-id='${this.id}'] .button--status`);e.addEventListener("click",()=>{e.closest(".library__item").remove(),t("remove",this.id)}),s.addEventListener("click",()=>{s.textContent="read"===s.textContent?"unread":"read",t("toggle",this.id)})}}new class{constructor(){this.storage=[],this.isValid=!1}updateLocalStorage(){localStorage.storage=JSON.stringify(this.storage)}deleteLocalStorage(){localStorage.storage=JSON.stringify([])}updateErrorMessage(t=""){r.textContent=t}updateStorage(t,e){"remove"===t&&(this.storage=this.storage.filter(t=>t.id!==e)),"toggle"===t&&(this.storage=this.storage.map(t=>(t.id===e&&t.toggleStatus(),t))),this.updateLocalStorage()}addBook(t){let e=Object.fromEntries(new FormData(t.target));e.id=this.storage.length+1;let{id:s,name:a,author:r,pages:i,status:o}=e;this.updateErrorMessage("");let l=new d(s,a,r,i,o);this.storage.push(l),t.target.reset(),l.render(),l.addHandlers(this.updateStorage.bind(this)),this.updateLocalStorage()}handleFormSubmit(t){t.preventDefault(),this.addBook(t),console.log(e),e.forEach(t=>{t.classList.remove("valid")})}checkValidity(t){let e=t.target.form,s=t.target,a=e.checkValidity();""===s.value?(this.updateErrorMessage(""),s.classList.remove("invalid"),s.classList.remove("valid")):s.checkValidity()?(this.updateErrorMessage(""),s.classList.remove("invalid"),s.classList.add("valid")):(this.updateErrorMessage(s.dataset.errorMessage),s.classList.add("invalid"),s.classList.remove("valid")),e.querySelector(".button").disabled=!a}addHandlers(){a.addEventListener("click",()=>{t.reset(),this.storage=[],s.innerHTML="",this.deleteLocalStorage()}),t.addEventListener("input",t=>this.checkValidity(t)),t.addEventListener("submit",t=>this.handleFormSubmit(t))}init(){let t=localStorage.storage;t&&(this.storage=JSON.parse(t).map(t=>{let{id:e,name:s,author:a,pages:r,status:i}=t,o=new d(e,s,a,r,i);return o.render(),o.addHandlers(this.updateStorage.bind(this)),o})),t||(localStorage.storage=JSON.stringify([])),this.addHandlers()}}().init();
//# sourceMappingURL=index.0dc2364a.js.map
